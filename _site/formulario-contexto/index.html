<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Contexto Profesional para Portafolio Docente 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        h1, h2, h3, h4 { font-family: 'Roboto Slab', serif; }
        .accordion-content { display: none; overflow: hidden; transition: max-height 0.4s ease-out; }
        .accordion-button.active .arrow-icon { transform: rotate(180deg); }
        label { font-weight: 600; color: #374151; }
        input[type="text"], input[type="number"], select, textarea { background-color: #f9fafb; border-color: #d1d5db; transition: all 0.2s ease-in-out; }
        input[type="text"]:focus, input[type="number"]:focus, select:focus, textarea:focus { --tw-ring-color: #3b82f6; border-color: #3b82f6; box-shadow: 0 0 0 2px var(--tw-ring-color); }
        .tooltip { position: relative; display: inline-block; }
        .tooltip .tooltiptext { visibility: hidden; width: 280px; background-color: #2c3e50; color: #fff; text-align: left; border-radius: 6px; padding: 10px; position: absolute; z-index: 10; bottom: 125%; left: 50%; margin-left: -140px; opacity: 0; transition: opacity 0.3s; font-family: 'Inter', sans-serif; font-weight: 400; font-size: 0.875rem; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
    </style>
</head>
<body class="antialiased text-gray-800">

    <header class="bg-gradient-to-r from-blue-800 to-indigo-900 text-white shadow-lg">
        <div class="container mx-auto px-6 py-12 text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight">Formulario de Contexto Profesional</h1>
            <p class="mt-4 text-lg text-indigo-200 max-w-3xl mx-auto">La base para un Portafolio Docente de Excelencia 2025</p>
        </div>
    </header>

    <main class="container mx-auto px-4 md:px-6 py-10">
        <div id="portfolio-form-container" class="bg-white p-6 md:p-8 rounded-2xl shadow-2xl border border-gray-200">

            <div class="bg-blue-50 border-l-4 border-blue-500 text-blue-800 p-6 rounded-r-lg mb-8">
                <h2 class="font-bold text-xl mb-2">Objetivo de este Formulario</h2>
                <p class="text-base">Este formulario está diseñado para recopilar la información esencial de tu práctica pedagógica. Completar cada campo con detalle es el primer paso para construir un portafolio que cumpla con los criterios de los niveles <strong>Competente y Destacado</strong>. Al usar tus propias experiencias, aseguramos un resultado auténtico y personalizado. Las ampolletas (💡) contienen pistas y ejemplos para ayudarte.</p>
            </div>

            <!-- SECCIÓN 1: IDENTIFICACIÓN -->
            <div class="border-b border-gray-200 py-4">
                <button class="accordion-button active w-full flex justify-between items-center text-left text-xl font-bold text-gray-800 focus:outline-none">
                    <span><span class="text-blue-600">I.</span> Identificación General</span>
                    <svg class="arrow-icon w-6 h-6 text-gray-500 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content mt-4 space-y-6" style="display: block; max-height: 500px;">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="nombre" class="block mb-2">Nombre Completo del Docente</label>
                            <input type="text" id="nombre" class="w-full p-3 border rounded-lg" placeholder="Ej: Marcela Andrea Pérez Soto">
                        </div>
                        <div>
                            <label for="establecimiento" class="block mb-2">Establecimiento Educativo</label>
                            <input type="text" id="establecimiento" class="w-full p-3 border rounded-lg" placeholder="Ej: Complejo Educacional Javiera Carrera">
                        </div>
                    </div>
                    <div>
                        <label for="tipo_evaluacion" class="block mb-2">Tipo de Evaluación / Manual</label>
                        <select id="tipo_evaluacion" class="w-full p-3 border rounded-lg">
                            <option selected disabled>Seleccione el manual correspondiente...</option>
                            <option value="basica_asignaturas">Ed. Básica Asignaturas (1° a 6°)</option>
                            <option value="basica_generalista">Ed. Básica Generalista (1° y 2°)</option>
                            <option value="media_hc">Ed. Media Humanístico-Científica (7° a 4°M)</option>
                            <option value="media_tp">Ed. Media Técnico Profesional</option>
                            <option value="parvularia">Educación Parvularia</option>
                            <option value="especial_regular">Educación Especial en Escuela Regular (PIE)</option>
                            <option value="especial_especial">Educación Especial en Escuela Especial (NEEP)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 2: CONTEXTO ESTABLECIMIENTO Y CURSO -->
            <div class="border-b border-gray-200 py-4">
                <button class="accordion-button w-full flex justify-between items-center text-left text-xl font-bold text-gray-800 focus:outline-none">
                    <span><span class="text-blue-600">II.</span> Contexto del Establecimiento y Curso</span>
                    <svg class="arrow-icon w-6 h-6 text-gray-500 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content mt-4 space-y-6">
                    <div>
                        <label for="pei" class="block mb-2">Sellos o Énfasis del PEI 
                            <div class="tooltip">💡<span class="tooltiptext">Menciona 2-3 ideas clave del Proyecto Educativo. Esto nos ayuda a alinear las reflexiones con la identidad de tu escuela. Ej: Sello ecológico, excelencia académica, formación ciudadana, católico, etc.</span></div>
                        </label>
                        <textarea id="pei" rows="3" class="w-full p-3 border rounded-lg" placeholder="Describe los sellos principales de tu establecimiento..."></textarea>
                    </div>
                    <div>
                        <label for="recursos" class="block mb-2">Recursos e Infraestructura Relevante
                            <div class="tooltip">💡<span class="tooltiptext">Describe los recursos clave de tu sala o espacios que usas. Esto es vital para que las planificaciones sean realistas. Ej: Pizarra interactiva, acceso a Chromebooks, laboratorio, gimnasio, patio pequeño, etc.</span></div>
                        </label>
                        <textarea id="recursos" rows="3" class="w-full p-3 border rounded-lg" placeholder="Describe los recursos disponibles y sus limitaciones..."></textarea>
                    </div>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label for="total_estudiantes" class="block mb-2">N° Total de Estudiantes</label>
                            <input type="number" id="total_estudiantes" class="w-full p-3 border rounded-lg" placeholder="Ej: 38">
                        </div>
                        <div>
                            <label for="pie_estudiantes" class="block mb-2">N° Estudiantes PIE</label>
                            <input type="number" id="pie_estudiantes" class="w-full p-3 border rounded-lg" placeholder="Ej: 4">
                        </div>
                        <div>
                            <label for="ive" class="block mb-2">Índice de Vulnerabilidad (%)</label>
                            <input type="number" id="ive" class="w-full p-3 border rounded-lg" placeholder="Ej: 85">
                        </div>
                    </div>
                    <div>
                        <label for="caracteristicas_curso" class="block mb-2">Características Generales del Curso
                            <div class="tooltip">💡<span class="tooltiptext">Describe la "personalidad" del curso. ¿Son participativos, tímidos, cohesionados? ¿Cómo es su relación contigo y entre ellos? Esto es clave para fundamentar el ambiente de aula.</span></div>
                        </label>
                        <textarea id="caracteristicas_curso" rows="4" class="w-full p-3 border rounded-lg" placeholder="Describe la dinámica de la clase, niveles de participación, relaciones interpersonales..."></textarea>
                    </div>
                     <div>
                        <label for="caracteristicas_pie" class="block mb-2">Necesidades Educativas Específicas (PIE y otros)
                            <div class="tooltip">💡<span class="tooltiptext">Describe cómo se manifiestan las necesidades en tu clase (no solo diagnósticos). Ej: "3 estudiantes con TDAH que requieren instrucciones segmentadas", "Un estudiante con TEL que necesita apoyo visual para el vocabulario".</span></div>
                        </label>
                        <textarea id="caracteristicas_pie" rows="4" class="w-full p-3 border rounded-lg" placeholder="Describe las necesidades de apoyo de tus estudiantes (PIE o no) y cómo se integran..."></textarea>
                    </div>
                    <div>
                        <label for="intereses" class="block mb-2">Intereses y Motivaciones de los Estudiantes
                             <div class="tooltip">💡<span class="tooltiptext">¿Qué les apasiona? ¿Videojuegos, música, deportes, temas sociales? Esta es información de oro para crear actividades contextualizadas y lograr un desempeño Destacado.</span></div>
                        </label>
                        <textarea id="intereses" rows="3" class="w-full p-3 border rounded-lg" placeholder="Ej: Fútbol, videojuegos (Fortnite), música urbana, interés por el medio ambiente..."></textarea>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 3: PRÁCTICA PEDAGÓGICA -->
            <div class="border-b border-gray-200 py-4">
                <button class="accordion-button w-full flex justify-between items-center text-left text-xl font-bold text-gray-800 focus:outline-none">
                    <span><span class="text-blue-600">III.</span> Tu Práctica Pedagógica y Foco del Portafolio</span>
                    <svg class="arrow-icon w-6 h-6 text-gray-500 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content mt-4 space-y-6">
                    <div>
                        <label for="fortaleza_profesional" class="block mb-2">Tu Principal Fortaleza como Docente
                            <div class="tooltip">💡<span class="tooltiptext">Sé específico. En lugar de "soy cercano", prueba "Genero un ambiente de confianza a través del humor y conectando los contenidos con sus intereses". Esto enriquece las reflexiones.</span></div>
                        </label>
                        <textarea id="fortaleza_profesional" rows="3" class="w-full p-3 border rounded-lg" placeholder="Describe una fortaleza y da un ejemplo concreto de cómo la aplicas..."></textarea>
                    </div>
                    <div>
                        <label for="necesidad_profesional" class="block mb-2">Un Aspecto a Mejorar (Autoevaluación)
                            <div class="tooltip">💡<span class="tooltiptext">Esta información es clave para la Tarea de Reflexión Socioemocional y para mostrar capacidad de autocrítica. Ej: "Me cuesta diversificar las evaluaciones más allá de la prueba escrita".</span></div>
                        </label>
                        <textarea id="necesidad_profesional" rows="3" class="w-full p-3 border rounded-lg" placeholder="Describe un área que te gustaría fortalecer y por qué..."></textarea>
                    </div>
                    <div>
                        <label for="foco_portafolio" class="block mb-2">Foco para la Planificación y Clase Grabada
                            <div class="tooltip">💡<span class="tooltiptext">Define qué habilidad o contenido central quieres que sea el eje de tus Módulos 1 y 2. Esto nos dará coherencia. Ej: "Quiero centrarme en desarrollar la comprensión lectora de textos informativos".</span></div>
                        </label>
                        <textarea id="foco_portafolio" rows="3" class="w-full p-3 border rounded-lg" placeholder="Indica la habilidad o contenido que será el hilo conductor..."></textarea>
                    </div>
                </div>
            </div>
            
            <!-- SECCIÓN 4: CLASE GRABADA -->
            <div class="border-b border-gray-200 py-4">
                <button class="accordion-button w-full flex justify-between items-center text-left text-xl font-bold text-gray-800 focus:outline-none">
                    <span><span class="text-blue-600">IV.</span> Módulo 2 - La Clase Grabada</span>
                    <svg class="arrow-icon w-6 h-6 text-gray-500 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content mt-4 space-y-6">
                    <div class="flex items-start p-4 bg-gray-50 rounded-lg">
                        <input id="crear_clase" type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-1">
                        <label for="crear_clase" class="ml-3 text-base text-gray-700 font-normal">No tengo una idea clara, por favor crea una propuesta completa (libreto, presentación y material) basada en mi contexto.</label>
                    </div>
                    <div>
                        <label for="oa_grabada" class="block mb-2">OA curricular de la clase a grabar</label>
                        <textarea id="oa_grabada" rows="3" class="w-full p-3 border rounded-lg" placeholder="Copia y pega aquí el OA de las Bases Curriculares que será el eje de tu clase."></textarea>
                    </div>
                     <div>
                        <label for="idea_clase" class="block mb-2">Idea inicial para tu clase de 40 minutos
                            <div class="tooltip">💡<span class="tooltiptext">Describe brevemente qué te gustaría hacer. No tiene que ser perfecto. Ej: "Quiero hacer una actividad grupal donde los estudiantes debatan sobre un tema polémico usando conectores argumentativos".</span></div>
                        </label>
                        <textarea id="idea_clase" rows="4" class="w-full p-3 border rounded-lg" placeholder="Describe el tema, la actividad central, cómo se conecta con la unidad, etc."></textarea>
                    </div>
                    <div>
                        <label for="materiales_grabada" class="block mb-2">Materiales que usarás en la clase grabada</label>
                        <textarea id="materiales_grabada" rows="3" class="w-full p-3 border rounded-lg" placeholder="Ej: Pizarra interactiva, guías impresas, tarjetas con imágenes, etc."></textarea>
                    </div>
                    <div>
                        <label for="estereotipos_genero" class="block mb-2">¿Cómo abordarás la equidad de género?
                            <div class="tooltip">💡<span class="tooltiptext">Piensa en cómo tus materiales, ejemplos o la forma de agrupar a los estudiantes pueden ayudar a evitar estereotipos. Ej: "Usaré imágenes de hombres y mujeres en roles no tradicionales", "Fomentaré la participación equitativa en los grupos".</span></div>
                        </label>
                        <textarea id="estereotipos_genero" rows="3" class="w-full p-3 border rounded-lg" placeholder="Describe una acción concreta para promover la equidad de género..."></textarea>
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 5: TRABAJO COLABORATIVO -->
            <div class="py-4">
                <button class="accordion-button w-full flex justify-between items-center text-left text-xl font-bold text-gray-800 focus:outline-none">
                    <span><span class="text-blue-600">V.</span> Módulo 3 - Trabajo Colaborativo</span>
                    <svg class="arrow-icon w-6 h-6 text-gray-500 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-content mt-4 space-y-6">
                    <div class="bg-amber-50 border-l-4 border-amber-500 text-amber-800 p-4 rounded-r-lg">
                        <h4 class="font-bold">Importante: ¿Qué es y qué no es Trabajo Colaborativo?</h4>
                        <p class="text-sm mt-2"><strong>SÍ es:</strong> Reunirse con colegas para analizar datos (ej: resultados de una prueba), identificar un problema de aprendizaje y diseñar juntos una nueva estrategia para abordarlo.</p>
                        <p class="text-sm mt-1"><strong>NO es:</strong> Simplemente compartir materiales, planificar un acto cívico sin un foco pedagógico, o repartirse el trabajo sin una reflexión conjunta sobre el aprendizaje de los estudiantes.</p>
                    </div>
                    <div class="flex items-start p-4 bg-gray-50 rounded-lg">
                        <input id="crear_colaborativo" type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-1">
                        <label for="crear_colaborativo" class="ml-3 text-base text-gray-700 font-normal">No he realizado una experiencia de trabajo colaborativo o la que hice no cumple los requisitos. Por favor, crea una propuesta completa basada en mi contexto.</label>
                    </div>
                    <div>
                        <label for="participantes_colab" class="block mb-2">Participantes y Asignaturas
                            <div class="tooltip">💡<span class="tooltiptext">Nombra a tus colegas y sus asignaturas. Ej: "Carolina (Lenguaje) y Javier (Ciencias)". Si aún no lo has hecho, piensa con quiénes podrías trabajar.</span></div>
                        </label>
                        <input type="text" id="participantes_colab" class="w-full p-3 border rounded-lg" placeholder="Nombres y asignaturas de los colegas...">
                    </div>
                    <div>
                        <label for="problema_colab" class="block mb-2">Problemática Detectada y Evidencias
                            <div class="tooltip">💡<span class="tooltiptext">¿Qué problema o necesidad abordaron (o abordarían)? Sé específico. ¿Qué datos usaron (o usarían)? Ej: "Bajos resultados en la habilidad de reflexionar en la prueba DIA".</span></div>
                        </label>
                        <textarea id="problema_colab" rows="4" class="w-full p-3 border rounded-lg" placeholder="Describe el problema y las evidencias que usaron (o podrían usar)..."></textarea>
                    </div>
                    <div>
                        <label for="proceso_colab" class="block mb-2">Proceso del Grupo (Diálogo y Decisiones)
                            <div class="tooltip">💡<span class="tooltiptext">Resume cómo fue (o cómo imaginas) el trabajo. ¿Hubo desacuerdos? ¿Cómo llegaron a un consenso? Ej: "Nos reuniríamos quincenalmente para analizar avances y ajustar la estrategia".</span></div>
                        </label>
                        <textarea id="proceso_colab" rows="4" class="w-full p-3 border rounded-lg" placeholder="Resume el proceso de trabajo en equipo..."></textarea>
                    </div>
                </div>
            </div>
            
            <div class="mt-10 flex flex-col md:flex-row items-center justify-center gap-4">
                <button id="download-pdf" class="w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-10 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                    Descargar Informe en PDF
                </button>
            </div>
            <div class="mt-4 text-center">
                <span id="autosave-status" class="text-sm text-gray-500 italic transition-opacity duration-500 opacity-0"></span>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const formContainer = document.getElementById('portfolio-form-container');
            const formElements = formContainer.querySelectorAll('input, select, textarea');
            const statusElement = document.getElementById('autosave-status');

            // --- Accordion Logic (CORRECTED) ---
            const accordionButtons = document.querySelectorAll('.accordion-button');
            accordionButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    button.classList.toggle('active');

                    if (button.classList.contains('active')) {
                        content.style.display = 'block';
                        setTimeout(() => {
                            content.style.maxHeight = content.scrollHeight + "px";
                        }, 10);
                    } else {
                        content.style.maxHeight = null;
                        setTimeout(() => {
                            content.style.display = 'none';
                        }, 400); // Match transition duration
                    }
                });
            });
            
            // --- Autosave Logic ---
            const saveForm = () => {
                const formData = {};
                formElements.forEach(el => { 
                    if (el.type === 'checkbox') {
                        formData[el.id] = el.checked;
                    } else {
                        formData[el.id] = el.value;
                    }
                });
                localStorage.setItem('portfolioFormData', JSON.stringify(formData));
                
                statusElement.textContent = `Autoguardado a las ${new Date().toLocaleTimeString()}`;
                statusElement.classList.remove('opacity-0');
                setTimeout(() => { statusElement.classList.add('opacity-0'); }, 2000);
            };

            const loadForm = () => {
                const savedData = localStorage.getItem('portfolioFormData');
                if (savedData) {
                    const formData = JSON.parse(savedData);
                    formElements.forEach(el => {
                        if (formData[el.id] !== undefined) { 
                            if (el.type === 'checkbox') {
                                el.checked = formData[el.id];
                            } else {
                                el.value = formData[el.id];
                            }
                        }
                    });
                }
            };

            loadForm();
            let saveInterval = setInterval(saveForm, 30000);
            formElements.forEach(el => el.addEventListener('input', saveForm));

            // --- PDF Download Logic ---
            document.getElementById('download-pdf').addEventListener('click', () => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({ orientation: 'p', unit: 'mm', format: 'a4' });
                
                let y = 15;
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 15;
                const maxWidth = pdf.internal.pageSize.getWidth() - margin * 2;

                const addText = (label, value) => {
                    if (!value) return;
                    
                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(12);
                    const labelLines = pdf.splitTextToSize(label, maxWidth);
                    
                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(10);
                    const valueLines = pdf.splitTextToSize(value.toString(), maxWidth);
                    
                    const requiredHeight = (labelLines.length * 7) + (valueLines.length * 5) + 8;

                    if (y + requiredHeight > pageHeight - margin) {
                        pdf.addPage();
                        y = margin;
                    }
                    
                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(12);
                    pdf.setTextColor(44, 62, 80);
                    pdf.text(labelLines, margin, y);
                    y += (labelLines.length * 7);
                    
                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(10);
                    pdf.setTextColor(52, 73, 94);
                    pdf.text(valueLines, margin, y);
                    y += (valueLines.length * 5) + 10;
                };
                
                pdf.setFont('helvetica', 'bold');
                pdf.setFontSize(20);
                pdf.text('Informe de Contexto Profesional', margin, y);
                y += 15;

                formElements.forEach(el => {
                    const labelElement = document.querySelector(`label[for='${el.id}']`);
                    if (labelElement) {
                        const labelText = labelElement.textContent.replace('💡','').trim();
                        let value;
                        if (el.type === 'checkbox') {
                            value = el.checked ? 'Sí, crear propuesta completa.' : 'No, usaré mi propia idea.';
                        } else if (el.tagName === 'SELECT' && el.options[el.selectedIndex]) {
                            value = el.options[el.selectedIndex].text;
                        } else {
                            value = el.value;
                        }
                        
                        if (value && (el.type !== 'checkbox' || el.checked)) {
                             addText(labelText, value);
                        }
                    }
                });
                
                const docenteName = document.getElementById('nombre').value.trim().replace(/ /g, '_') || 'docente';
                pdf.save(`Informe_Contexto_${docenteName}.pdf`);
            });
        });
    </script>

</body>
</html>
