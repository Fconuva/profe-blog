<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscripción: Paseo de Docentes a la Playa 2025 - Francisco Javier Núñez Valenzuela</title>
    
    <meta name="description" content="Profesor de Lengua y Literatura. Explora mis servicios de asesoría para la Evaluación Docente, material educativo y herramientas interactivas.">
    
    <!-- Theme & social preview -->
    <meta name="theme-color" content="#2563eb">
    <meta property="og:title" content="Inscripción: Paseo de Docentes a la Playa 2025 - Francisco Javier Núñez Valenzuela">
    <meta property="og:description" content="Profesor de Lengua y Literatura. Explora mis servicios de asesoría para la Evaluación Docente, material educativo y herramientas interactivas.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://profefranciscopancho.com/">
    <meta property="og:image" content="https://profefranciscopancho.com/imagenes/logo-profe-francisco-nuevo.svg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@profefranciscopancho">

    <!-- Favicons / app manifest -->
    <link rel="apple-touch-icon" href="/imagenes/logo-profe-francisco-nuevo.svg">
    <link rel="icon" href="/imagenes/logo-profe-francisco-nuevo.svg" type="image/svg+xml" sizes="any">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="canonical" href="https://profefranciscopancho.com/">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Inter:wght@400;500;600;700&family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/design-tokens.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/premium-styles.css">

    <!-- Preload premium scripts -->
    <link rel="preload" href="/main-premium.js" as="script">

    
    

    <!-- Configuración de Tailwind con tema oscuro -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
                        'fade-in-left': 'fadeInLeft 0.8s ease-out forwards',
                        'fade-in-right': 'fadeInRight 0.8s ease-out forwards',
                        'float': 'float 3s ease-in-out infinite',
                        'pulse-glow': 'pulse-glow 2s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(30px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        fadeInLeft: {
                            '0%': { opacity: '0', transform: 'translateX(-30px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' }
                        },
                        fadeInRight: {
                            '0%': { opacity: '0', transform: 'translateX(30px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' }
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' }
                        },
                        'pulse-glow': {
                            '0%, 100%': { boxShadow: '0 0 20px rgba(59, 130, 246, 0.3)' },
                            '50%': { boxShadow: '0 0 30px rgba(59, 130, 246, 0.6)' }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-100 transition-colors duration-300">

    <header class="header-enhanced sticky top-0 z-50" role="banner">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center" role="navigation" aria-label="Main navigation">
            <a href="/" class="flex items-center space-x-3" aria-label="Inicio">
                <img src="/imagenes/logo-profe-francisco-nuevo.svg" alt="Logo Profe Francisco - Átomo del Conocimiento" class="h-12 w-auto interactive-hover rounded-lg"/>
                <span class="text-lg font-extrabold professional-name interactive-text">Francisco Javier Núñez</span>
            </a>

            <div class="hidden md:flex items-center space-x-6">
                <a href="/#sobre-mi" class="nav-link interactive-hover interactive-text relative group">
                    Sobre Mí
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="/#servicios" class="nav-link interactive-hover interactive-text relative group">
                    Servicios
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="/#apps" class="nav-link interactive-hover interactive-text relative group">
                    Herramientas
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="/privado/" class="nav-link interactive-hover interactive-text relative group">
                    <i class="fas fa-lock mr-1"></i>Privado
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="/tips-carrera-docente/" class="nav-link interactive-hover interactive-text relative group">
                    Tips Docentes
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="/portafolio/" class="nav-link interactive-hover interactive-text relative group">
                    Portafolio
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="/contacto/" class="btn-premium">Contacto</a>
            </div>

            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-gray-800 dark:text-gray-200 focus:outline-none p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-expanded="false" aria-controls="mobile-menu">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/>
                    </svg>
                </button>
            </div>
        </nav>

        <div id="mobile-menu" class="md:hidden hidden bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg" role="menu">
            <a href="/#sobre-mi" class="block py-3 px-6 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" role="menuitem">Sobre Mí</a>
            <a href="/#servicios" class="block py-3 px-6 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" role="menuitem">Servicios</a>
            <a href="/#apps" class="block py-3 px-6 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" role="menuitem">Herramientas</a>
            <a href="/privado/" class="block py-3 px-6 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" role="menuitem">
                <i class="fas fa-lock mr-2"></i>Privado
            </a>
            <a href="/tips-carrera-docente/" class="block py-3 px-6 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" role="menuitem">Tips Docentes</a>
            <a href="/portafolio/" class="block py-3 px-6 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" role="menuitem">Portafolio</a>
            <a href="/contacto/" class="block py-3 px-6 text-blue-600 dark:text-blue-400 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors" role="menuitem">Contacto</a>
        </div>
    </header>

    <main>
        
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscripción Interactiva: Paseo de Docentes a la Playa 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .form-container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .info-box {
            background-color: #F3F4F6;
            border-left: 4px solid #3B82F6;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 8px;
        }
        .btn {
            background-color: #2563EB;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            width: auto;
            min-width: 150px;
            transition: background-color 0.3s;
            cursor: pointer;
        }
        .btn:hover {
            background-color: #1D4ED8;
        }
        .btn:disabled {
            background-color: #9CA3AF;
            cursor: not-allowed;
        }
        .btn-secondary {
            background-color: #6B7281;
        }
        .btn-secondary:hover {
            background-color: #4B5563;
        }
         .btn-danger {
            background-color: #DC2626;
        }
        .btn-danger:hover {
            background-color: #B91C1C;
        }
        .bus-layout {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            padding: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            border: 2px solid #ccc;
        }
        .seat {
            height: 40px;
            background-color: #4CAF50;
            color: white;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
            position: relative;
        }
        .seat.taken {
            background-color: #F44336;
            cursor: not-allowed;
        }
        .seat.mine {
            background-color: #FFC107;
            color: #333;
            border: 2px solid #FFA000;
        }
        .seat.taken .tooltip, .seat.mine .tooltip {
            visibility: visible;
            opacity: 1;
        }
        .seat:not(.taken):not(.mine):hover {
            background-color: #45a049;
        }
        .seat.aisle {
            background-color: transparent;
            border: none;
            cursor: default;
        }
        .seat .tooltip {
            visibility: hidden;
            width: max-content;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .seat .tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }
        .modal {
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 400px;
            border-radius: 10px;
        }
        .step-section {
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-top: 1.5rem;
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="form-container">
        <!-- Encabezado -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">Paseo de Docentes a la Playa</h1>
            <p class="text-xl font-semibold text-blue-600 mt-1">"Donde Gilberto" - Viernes, 08 de Noviembre</p>
        </div>

        <!-- Descripción -->
        <div class="info-box">
            <h2 class="font-bold text-gray-800 mb-2">Descripción de la Actividad</h2>
            <p class="text-gray-700 text-sm">
                Disfrutaremos de una jornada de camaradería y relajo. El día comenzará a las <strong>11:00 AM</strong> con un aperitivo de bienvenida, seguido de un delicioso almuerzo y, para finalizar, una once. Tendremos a nuestra disposición todas las instalaciones del recinto para compartir y descansar.
            </p>
        </div>

        <!-- Instrucción WhatsApp -->
        <div class="info-box border-l-amber-500 bg-amber-50">
            <h2 class="font-bold text-amber-800 mb-2">Instrucción Obligatoria</h2>
            <p class="text-amber-700 text-sm mb-4">
                Para mantener a todos informados sobre los detalles y cualquier novedad del paseo, es requisito unirse al grupo de difusión de WhatsApp.
            </p>
             <a href="https://chat.whatsapp.com/CVg4jRdMUcnJwQY0pBpWVg?mode=ems_copy_t" target="_blank" rel="noopener noreferrer" class="w-full flex items-center justify-center gap-3 p-3 rounded-lg bg-green-500 hover:bg-green-600 text-white font-bold transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2 22l5.25-1.38c1.45.79 3.08 1.21 4.79 1.21 5.46 0 9.91-4.45 9.91-9.91S17.5 2 12.04 2zM12.04 20.15c-1.49 0-2.93-.4-4.19-1.15l-.3-.18-3.12.82.83-3.04-.2-.31c-.82-1.31-1.26-2.83-1.26-4.38 0-4.54 3.67-8.21 8.21-8.21 2.23 0 4.33.87 5.81 2.44s2.44 3.58 2.44 5.81c0 4.54-3.67 8.21-8.21 8.21zm4.49-5.32c-.24-.12-1.42-.7-1.64-.78-.23-.08-.39-.12-.56.12-.17.24-.62.78-.76.93-.14.16-.28.18-.52.06-.24-.12-1.02-.37-1.94-1.2-1.12-.99-1.55-1.85-1.7-2.17-.15-.31-.02-.48.1-.63.11-.13.24-.35.37-.52.12-.17.16-.28.24-.47.08-.19.04-.36-.02-.48s-.56-1.34-.76-1.84c-.2-.48-.41-.42-.56-.42h-.48c-.17 0-.44.06-.68.31-.24.24-.93.9-1.08 2.18-.15 1.28.62 2.52.71 2.69.09.17 1.8 2.74 4.36 3.82 2.56 1.08 2.56.72 3.03.69.46-.03 1.42-.58 1.62-1.14.2-.56.2-1.04.14-1.14-.06-.11-.23-.17-.47-.29z"/>
                </svg>
                Unirse al Grupo de WhatsApp
            </a>
        </div>
        
        <!-- Requisitos -->
        <div class="info-box border-l-red-500 bg-red-50">
            <h2 class="font-bold text-red-800 mb-2">Requisitos para Asistir</h2>
            <ul class="list-disc list-inside text-red-700 text-sm space-y-1">
                <li>Ser docente del Centro Educativo Salesianos Talca.</li>
                <li>Tener una antigüedad mínima de 3 meses en el establecimiento al día del evento (08 de noviembre).</li>
            </ul>
        </div>


        <!-- Contenido principal dinámico -->
        <div id="main-content">

            <!-- Paso 0: Datos Personales -->
            <div id="step0-personal-data" class="step-section">
                <h3 class="block mb-4 font-medium text-lg text-gray-800">Para comenzar, por favor completa tus datos:</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="fullNameInput" class="block text-sm font-medium text-gray-700">Nombre Completo</label>
                        <input type="text" id="fullNameInput" class="mt-1 w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Nombre y Apellido" required>
                    </div>
                    <div>
                        <label for="rutInput" class="block text-sm font-medium text-gray-700">RUT</label>
                        <input type="text" id="rutInput" class="mt-1 w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="12.345.678-9" required>
                    </div>
                    <div class="md:col-span-2">
                        <label for="addressInput" class="block text-sm font-medium text-gray-700">Dirección</label>
                        <input type="text" id="addressInput" class="mt-1 w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Calle Falsa 123, Comuna" required>
                    </div>
                    <div>
                        <label for="emergencyPhoneInput" class="block text-sm font-medium text-gray-700">Teléfono de Emergencia</label>
                        <input type="tel" id="emergencyPhoneInput" class="mt-1 w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="+56 9 1234 5678" required>
                    </div>
                    <div>
                        <label for="ageInput" class="block text-sm font-medium text-gray-700">Edad</label>
                        <input type="number" id="ageInput" class="mt-1 w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Ej: 35" required>
                    </div>
                    <div>
                        <label for="genderInput" class="block text-sm font-medium text-gray-700">Género</label>
                        <select id="genderInput" class="mt-1 w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            <option value="">Seleccione una opción</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Femenino">Femenino</option>
                            <option value="Otro">Otro</option>
                            <option value="Prefiero no decir">Prefiero no decir</option>
                        </select>
                    </div>
                </div>
                <div class="mt-6 text-right">
                    <button class="btn" onclick="processPersonalData()">Guardar y Continuar</button>
                </div>
            </div>


            <!-- Paso 1: Asistencia -->
            <div id="step1-attendance" class="step-section hidden">
                <p class="block mb-3 font-medium text-lg text-gray-800">Hola <span id="userNameDisplay" class="font-bold"></span>, ¿asistirás a la actividad?</p>
                <div class="flex items-center space-x-6">
                    <button class="btn" onclick="handleAttendance(true)">Sí, asistiré</button>
                    <button class="btn btn-secondary" onclick="handleAttendance(false)">No, no puedo asistir</button>
                </div>
            </div>

            <!-- Paso 2: Transporte -->
            <div id="step2-transport" class="step-section hidden">
                <p class="block mb-3 font-medium text-lg text-gray-800">¡Genial! ¿Necesitarás transporte en el bus?</p>
                <div class="flex items-center space-x-6">
                    <button class="btn" onclick="handleTransport(true)">Sí, usaré el bus</button>
                    <button class="btn btn-secondary" onclick="handleTransport(false)">No, iré por mis medios</button>
                </div>
            </div>

            <!-- Paso 3: Selección de Asiento -->
            <div id="step3-bus-selection" class="hidden">
                 <h2 class="text-xl font-bold text-gray-800 my-4 text-center">Selección de Asientos en el Bus (46 Cupos)</h2>
                 <div class="flex flex-col md:flex-row gap-8">
                     <div class="w-full md:w-1/2">
                         <div class="bus-layout"></div>
                         <div class="flex justify-around mt-4 text-xs">
                             <div class="flex items-center"><span class="w-4 h-4 bg-green-500 rounded-full mr-2"></span> Disponible</div>
                             <div class="flex items-center"><span class="w-4 h-4 bg-red-500 rounded-full mr-2"></span> Ocupado</div>
                              <div class="flex items-center"><span class="w-4 h-4 bg-yellow-400 rounded-full mr-2"></span> Mi Asiento</div>
                         </div>
                     </div>
                     <div class="w-full md:w-1/2">
                         <h3 class="font-bold mb-2">Lista de Pasajeros:</h3>
                         <div id="passenger-list" class="h-64 overflow-y-auto bg-gray-50 p-3 rounded-lg border"></div>
                     </div>
                 </div>
            </div>
            
            <!-- Estados finales -->
            <div id="final-state-container" class="text-center p-6 bg-blue-50 border-l-4 border-blue-500 text-blue-800 rounded-lg mt-6 hidden">
                <p id="final-state-message" class="font-semibold"></p>
                <button id="reset-preference-btn" class="btn btn-danger mt-4" onclick="resetPreference()">Cambiar mi respuesta</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para confirmar reserva -->
    <div id="confirmModal" class="modal hidden">
      <div class="modal-content">
        <h2 class="text-xl font-bold mb-4">Reservar Asiento <span id="seat-number-modal" class="text-blue-600"></span></h2>
        <p class="mb-4">¿Confirmas que quieres reservar este asiento?</p>
        <div class="flex justify-end gap-3">
             <button onclick="closeModal('confirmModal')" class="btn btn-secondary">Cancelar</button>
             <button onclick="reserveSeat()" class="btn">Confirmar</button>
        </div>
      </div>
    </div>
    
    <!-- Modal para aviso de beneficio del bus -->
    <div id="busBenefitModal" class="modal hidden">
      <div class="modal-content">
        <h2 class="text-xl font-bold mb-4 text-center text-blue-600">Aviso Importante</h2>
        <p class="mb-6 text-center text-gray-700">Si tienes quien te pueda llevar, por favor deja este beneficio para aquellos que no disponen de vehículo o de alguien que los lleve.</p>
        <div class="flex flex-col gap-3">
             <button onclick="proceedToBusSelection()" class="btn">Entendido, necesito el cupo</button>
             <button onclick="declineTransport()" class="btn btn-secondary">No necesito el cupo, gracias</button>
        </div>
      </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot, collection, getDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Configuración de Firebase - Actualiza estos valores con tu configuración real
        const firebaseConfig = {
            apiKey: "AIzaSyBbW9QZ7rZ8QZ7rZ8QZ7rZ8QZ7rZ8QZ7rZ",
            authDomain: "profe-francisco-blog.firebaseapp.com",
            projectId: "profe-francisco-blog",
            storageBucket: "profe-francisco-blog.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef123456"
        };

        const appId = 'paseo-docentes-2025';

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        let userId = null;
        let selectedSeat = null;
        let userPreference = null;
        let personalData = {};

        const sections = {
            personalData: document.getElementById('step0-personal-data'),
            attendance: document.getElementById('step1-attendance'),
            transport: document.getElementById('step2-transport'),
            bus: document.getElementById('step3-bus-selection'),
            finalState: document.getElementById('final-state-container'),
        };

        const inputs = {
            fullName: document.getElementById('fullNameInput'),
            rut: document.getElementById('rutInput'),
            address: document.getElementById('addressInput'),
            emergencyPhone: document.getElementById('emergencyPhoneInput'),
            age: document.getElementById('ageInput'),
            gender: document.getElementById('genderInput')
        };

        const modals = {
            confirmModal: document.getElementById('confirmModal'),
            busBenefitModal: document.getElementById('busBenefitModal')
        }

        const busLayout = document.querySelector('.bus-layout');
        const passengerList = document.getElementById('passenger-list');
        const seatNumberModal = document.getElementById('seat-number-modal');
        const userNameDisplay = document.getElementById('userNameDisplay');
        
        const seatMap = [
             1,  2, null,  3,  4, 
             5,  6, null,  7,  8, 
             9, 10, null, 11, 12,
            13, 14, null, 15, 16, 
            17, 18, null, 19, 20, 
            21, 22, null, 23, 24,
            25, 26, null, 27, 28, 
            29, 30, null, 31, 32, 
            33, 34, null, 35, 36,
            37, 38, null, 39, 40, 
            41, 42, null, 43, 44, 
            45, 46, null, null, null
        ];

        function hideAllSteps() {
            Object.values(sections).forEach(sec => sec.classList.add('hidden'));
        }

        async function savePreference(preference) {
            if (!userId) return;
            const userDocRef = doc(db, `artifacts/${appId}/public/data/participantes`, userId);
            const dataToSave = { ...personalData, ...preference, timestamp: new Date() };
            await setDoc(userDocRef, dataToSave, { merge: true });
        }

        window.processPersonalData = () => {
            const data = {
                nombre: inputs.fullName.value.trim(),
                rut: inputs.rut.value.trim(),
                direccion: inputs.address.value.trim(),
                telefonoEmergencia: inputs.emergencyPhone.value.trim(),
                edad: inputs.age.value,
                genero: inputs.gender.value,
            };

            for (const key in data) {
                if (!data[key]) {
                    alert('Por favor, completa todos los campos de datos personales.');
                    return;
                }
            }
            personalData = data;
            hideAllSteps();
            userNameDisplay.textContent = data.nombre;
            sections.attendance.classList.remove('hidden');
        };

        window.handleAttendance = (attends) => {
            if (attends) {
                hideAllSteps();
                sections.transport.classList.remove('hidden');
            } else {
                savePreference({ asiste: false, necesitaTransporte: null, asiento: null });
            }
        };

        window.handleTransport = (needsTransport) => {
            if (needsTransport) {
                modals.busBenefitModal.classList.remove('hidden');
            } else {
                savePreference({ asiste: true, necesitaTransporte: false, asiento: null });
            }
        };
        
        window.declineTransport = () => {
            closeModal('busBenefitModal');
            savePreference({ asiste: true, necesitaTransporte: false, asiento: null });
        };

        window.proceedToBusSelection = () => {
            closeModal('busBenefitModal');
            hideAllSteps();
            sections.bus.classList.remove('hidden');
        }
        
        window.resetPreference = async () => {
             if (!userId) return;
             if(userPreference && userPreference.asiento){
                const seatDocRef = doc(db, `artifacts/${appId}/public/data/asientos-paseo`, String(userPreference.asiento));
                await deleteDoc(seatDocRef);
             }
             const userDocRef = doc(db, `artifacts/${appId}/public/data/participantes`, userId);
             await deleteDoc(userDocRef);
             userPreference = null;
             personalData = {};
             Object.values(inputs).forEach(input => {
                input.value = '';
                input.disabled = false;
             });
        }

        function renderUI() {
            hideAllSteps();
            if (!userPreference) {
                sections.personalData.classList.remove('hidden');
            } else {
                const { asiste, necesitaTransporte, asiento, ...savedPersonalData } = userPreference;
                personalData = savedPersonalData;
                Object.keys(inputs).forEach(key => {
                    const inputKeyMap = {
                        fullName: 'nombre', rut: 'rut', address: 'direccion',
                        emergencyPhone: 'telefonoEmergencia', age: 'edad', gender: 'genero'
                    };
                    const dataKey = inputKeyMap[key];
                     if(savedPersonalData[dataKey]) {
                         inputs[key].value = savedPersonalData[dataKey];
                         inputs[key].disabled = true;
                     }
                });

                let message = '';
                if (!asiste) {
                    message = 'Has confirmado que no asistirás. ¡Te echaremos de menos!';
                } else if (necesitaTransporte === false) {
                    message = '¡Gracias por confirmar! Has indicado que irás por tus propios medios. ¡Nos vemos allá!';
                } else if (necesitaTransporte === true && asiento) {
                    message = `Has reservado el asiento N°${asiento} en el bus. ¡Tu cupo está asegurado!`;
                    sections.bus.classList.remove('hidden');
                } else if (necesitaTransporte === true && !asiento) {
                    hideAllSteps();
                    sections.bus.classList.remove('hidden');
                    return;
                } else {
                     resetPreference();
                     return;
                }
                document.getElementById('final-state-message').textContent = message;
                sections.finalState.classList.remove('hidden');
            }
        }
        
        function createBusLayout(reservations) {
            if (!busLayout) return;
            busLayout.innerHTML = '';
            seatMap.forEach(seatNum => {
                const seatDiv = document.createElement('div');
                if (seatNum === null) {
                    seatDiv.className = 'seat aisle';
                } else {
                    const reservation = reservations.find(r => r.id === String(seatNum));
                    seatDiv.className = 'seat';
                    seatDiv.dataset.seat = seatNum;
                    seatDiv.textContent = seatNum;

                    if (reservation) {
                        seatDiv.classList.add('taken');
                        const tooltip = document.createElement('span');
                        tooltip.className = 'tooltip';
                        tooltip.textContent = reservation.nombre;
                        if(reservation.userId === userId){
                            seatDiv.classList.add('mine');
                            tooltip.textContent = "¡Este es tu asiento!"
                        }
                        seatDiv.appendChild(tooltip);
                    } else {
                        seatDiv.onclick = () => openModal('confirmModal', seatNum);
                    }
                }
                busLayout.appendChild(seatDiv);
            });
        }

        function updatePassengerList(reservations) {
            if (!passengerList) return;
            const sorted = [...reservations].sort((a, b) => parseInt(a.id) - parseInt(b.id));
            passengerList.innerHTML = sorted.length ? '' : '<p class="text-gray-500">Aún no hay pasajeros.</p>';
            sorted.forEach(res => {
                const p = document.createElement('p');
                p.className = 'text-sm mb-1';
                p.innerHTML = `<strong class="text-blue-600">Asiento ${res.id}:</strong> ${res.nombre}`;
                passengerList.appendChild(p);
            });
        }
        
        window.openModal = (modalName, seatNum) => {
            if (seatNum) {
                selectedSeat = seatNum;
                seatNumberModal.textContent = seatNum;
            }
            modals[modalName].classList.remove('hidden');
        };

        window.closeModal = (modalName) => {
            modals[modalName].classList.add('hidden');
            if (modalName === 'confirmModal') {
                selectedSeat = null;
            }
        };
        
        window.reserveSeat = async () => {
            if (selectedSeat) {
                await savePreference({ asiste: true, necesitaTransporte: true, asiento: selectedSeat });
                const seatDocRef = doc(db, `artifacts/${appId}/public/data/asientos-paseo`, String(selectedSeat));
                await setDoc(seatDocRef, { nombre: personalData.nombre, userId });
                closeModal('confirmModal');
            }
        };

        async function setupAuth() {
            try {
                await signInAnonymously(auth);
                userId = auth.currentUser.uid;
                console.log('Autenticación exitosa:', userId);
            } catch (error) {
                console.error("Error en la autenticación:", error);
                alert('Error al inicializar la aplicación. Por favor, recarga la página.');
            }
        }

        async function main() {
            await setupAuth();
            if (!userId) {
                console.error("Authentication failed. Cannot proceed.");
                return;
            }

            const userDocRef = doc(db, `artifacts/${appId}/public/data/participantes`, userId);
            onSnapshot(userDocRef, (docSnap) => {
                userPreference = docSnap.exists() ? docSnap.data() : null;
                renderUI();
            }, (error) => {
                console.error("Error listening to user preference:", error);
            });

            const seatsCollectionRef = collection(db, `artifacts/${appId}/public/data/asientos-paseo`);
            
            onSnapshot(seatsCollectionRef, (snapshot) => {
                const reservations = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                createBusLayout(reservations);
                updatePassengerList(reservations);
            }, (error) => {
                console.error("Error listening to seat reservations:", error);
            });
        }
        
        document.addEventListener('DOMContentLoaded', main);
    </script>
</body>
</html>
    </main>

    <footer class="bg-gray-900 dark:bg-gray-950 text-white py-12 relative overflow-hidden">
        <!-- Elementos decorativos -->
        <div class="absolute inset-0 bg-gradient-to-r from-blue-900/20 to-purple-900/20"></div>
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"></div>

        <div class="container mx-auto px-6 relative z-10">
            <div class="grid md:grid-cols-4 gap-8 mb-8">
                <!-- Información principal -->
                <div class="md:col-span-2">
                    <div class="flex items-center space-x-3 mb-4">
                        <img src="/imagenes/logo-profe-francisco-nuevo.svg" alt="Logo Profe Francisco - Átomo del Conocimiento" class="h-12 w-auto rounded-lg">
                        <div>
                            <h3 class="text-xl font-bold">Francisco Javier Núñez</h3>
                            <p class="text-gray-400 text-sm">Docente Especialista en Innovación Pedagógica</p>
                        </div>
                    </div>
                    <p class="text-gray-300 mb-4 max-w-md">
                        Transformando la educación a través de la innovación tecnológica y metodologías activas.
                        Más de 9 años de experiencia en el desarrollo docente.
                    </p>
                    <div class="flex space-x-4">
                        <a href="https://wa.me/56988138929" class="w-10 h-10 bg-green-600 hover:bg-green-700 rounded-lg flex items-center justify-center transition-colors" aria-label="WhatsApp">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                            </svg>
                        </a>
                        <a href="mailto:fconuva@gmail.com" class="w-10 h-10 bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center justify-center transition-colors" aria-label="Email">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                            </svg>
                        </a>
                        <a href="https://www.instagram.com/profefranciscojavier?igsh=MWc5NDZxZGg4ejIxMw==" class="w-10 h-10 bg-pink-600 hover:bg-pink-700 rounded-lg flex items-center justify-center transition-colors" aria-label="Instagram">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Enlaces rápidos -->
                <div>
                    <h4 class="text-lg font-semibold mb-4">Servicios</h4>
                    <ul class="space-y-2 text-gray-300">
                        <li><a href="/portafolio/" class="hover:text-white transition-colors">Portafolio Docente</a></li>
                        <li><a href="/tesis.html" class="hover:text-white transition-colors">Creación de Tesis</a></li>
                        <li><a href="/#servicios" class="hover:text-white transition-colors">Material Educativo</a></li>
                        <li><a href="/tips-carrera-docente/" class="hover:text-white transition-colors">Tips Docentes</a></li>
                    </ul>
                </div>

                <!-- Herramientas -->
                <div>
                    <h4 class="text-lg font-semibold mb-4">Herramientas</h4>
                    <ul class="space-y-2 text-gray-300">
                        <li><a href="/ruleta.html" class="hover:text-white transition-colors">Ruleta Interactiva</a></li>
                        <li><a href="/rosco.html" class="hover:text-white transition-colors">Rosco Interactivo</a></li>
                        <li><a href="/bingo.html" class="hover:text-white transition-colors">Bingo de Conceptos</a></li>
                        <li><a href="/simulador.html" class="hover:text-white transition-colors">Simulador de Sueldo</a></li>
                    </ul>
                </div>
            </div>

            <!-- Línea divisoria -->
            <div class="border-t border-gray-800 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-gray-400 text-sm">
                        &copy; 2025 Francisco Javier Núñez Valenzuela. Todos los derechos reservados.
                    </p>
                    <p class="text-gray-400 text-sm mt-2 md:mt-0">
                        Desarrollado con ❤️ para la innovación educativa
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="/main.js" defer></script>
    <script src="/main-premium.js" defer></script>

    <!-- Schema.org markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Francisco Javier Núñez Valenzuela",
        "jobTitle": "Docente de Lengua y Literatura",
        "description": "Docente especialista en innovación pedagógica con más de 9 años de experiencia",
        "url": "https://profefranciscopancho.com",
        "sameAs": [
            "https://profefranciscopancho.com"
        ],
        "knowsAbout": [
            "Educación",
            "Innovación Pedagógica",
            "Inteligencia Artificial en Educación",
            "Metodologías Activas",
            "Evaluación Docente"
        ]
    }
    </script>

</body>
</html>
